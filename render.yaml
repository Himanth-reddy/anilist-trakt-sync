services:
  - type: web
    name: anilist-trakt-sync
    env: node
    plan: free
    buildCommand: npm install && npm run build
    startCommand: npm start
    envVars:
      - key: NODE_VERSION
        value: 20.0.0
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: TRAKT_CLIENT_ID
        sync: false
      - key: TRAKT_CLIENT_SECRET
        sync: false
      - key: TRAKT_ACCESS_TOKEN
        sync: false
      - key: TRAKT_REFRESH_TOKEN
        sync: false

  - type: cron
    name: anilist-trakt-sync-cron
    env: node
    schedule: "0 */6 * * *" # Every 6 hours
    buildCommand: echo "No build needed for cron"
    startCommand: curl -X GET $APP_URL/api/cron
    envVars:
      - key: APP_URL
        sync: false # User must provide their app URL

